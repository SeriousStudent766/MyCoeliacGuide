{% extends 'navbar.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/health.css' %}">

<div class="health-wrapper">
    <!-- Profile Display -->
    <div id="view-profile" class="profile-card">
        <div class="profile-image">
            {% if profile.profile_picture %}
                <img src="{{ profile.profile_picture.url }}" alt="Profile Picture">
            {% else %}
                <img src="https://via.placeholder.com/120" alt="Default">
            {% endif %}
        </div>
        <h2>{{ request.user.username }}</h2>
        <p><strong>Weight:</strong> {{ profile.weight }} kg</p>
        <p><strong>Height:</strong> {{ profile.height }} cm</p>
        <p><strong>DOB:</strong> {{ profile.date_of_birth }}</p>
        <p><strong>Gender:</strong> {{ profile.sex }}</p>
        <button class="btn-edit" onclick="toggleEdit(true)">Update Profile</button>
    </div>

    <!-- Edit Profile Form -->
    <div id="edit-profile" class="profile-form" style="display: none;">
        <h2>Update Your Profile</h2>
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn-save"><i class='bx bxs-save'></i> Save Changes</button>
            <button type="button" class="btn-cancel" onclick="toggleEdit(false)">Cancel</button>
        </form>
    </div>
</div>

<script>
    function toggleEdit(showEdit) {
    const view = document.getElementById("view-profile");
    const edit = document.getElementById("edit-profile");

    if (showEdit) {
        view.style.opacity = 0;
        setTimeout(() => {
            view.style.display = "none";
            edit.style.display = "block";
            edit.style.opacity = 0;
            setTimeout(() => edit.style.opacity = 1, 10);
        }, 300);
    } else {
        edit.style.opacity = 0;
        setTimeout(() => {
            edit.style.display = "none";
            view.style.display = "block";
            view.style.opacity = 0;
            setTimeout(() => view.style.opacity = 1, 10);
        }, 300);
    }
}

</script>
{% endblock %}
